= Javadoc

== Введение

*Javadoc* является стандартным выводом для *Java API*. Создание *Javadoc* довольно простое. Javadoc генерируется с помощью так называемого _doclet_. Различные _doclets_ могут по-разному анализировать аннотации Java и создавать разные выходные данные. Но по большому счету почти каждая документация по Java использует стандартный _doclet_. Выходные данные *Javadoc* знакомы разработчикам Java и приветствуются ими.

*Javadoc* поддерживается *Oracle*. Разработчики могут интегрировать вывод *Javadoc* непосредственно в свою *IDE*, что делает документацию удобной и легко доступной. Фактически, *Javadoc* часто доставляется таким образом, а не разворачивается и загружается на сервер. *Javadoc* содержит только справочную документацию. В документацию нельзя добавлять какие-либо концептуальные файлы справки или изменять макет.

=== *Javadoc* и проверка ошибок

*Javadoc* можно генерировать вручную с помощью IDE.

*Javadoc* также проверяет теги по фактическому коду. Если есть параметры, исключения или возвраты, которые не соответствуют параметрам, исключениям или возвратам в фактическом коде, то *Javadoc* будет показывать предупреждения.

image::/assets/img/java/core/javadoc/error.png[Error]

=== Изучение параметров *Javadoc*

Можно попробовать удалять некоторые параметры из метода и снова генерировать Javadoc. Перед этим нужно убедиться, что окно консоли открыто, чтобы можно было видеть предупреждения об ошибках.

=== Автоматическое создание *Javadoc*

В большинстве проектов файл *Javadoc* никогда не создается вручную. *Javadoc* позволяет строить его из командной строки, передавая ему файл конфигурации. У большинства разработчиков есть инструмент управления сборкой, где они могут настраивать выходные данные из своего кода, включая *Javadoc*. Если разработчики попросят собрать *Javadoc*, скорее всего, их система управления сборкой может быть несколько примитивной. Тем не менее, может быть полезно создать выходные данные *Javadoc* самостоятельно, чтобы протестировать и просмотреть выходные данные, прежде чем создавать их с помощью инструмента управления сборкой.

== Тэги *Javadoc*

*Javadoc* - это генератор документов, который просматривает исходные файлы Java для конкретных аннотаций. Он анализирует аннотации в выводе *Javadoc*. Знать аннотации очень важно, потому что именно так создается *Javadoc*.

=== Комментарии или тэги *Javadoc*

Обычно комментарии в Java выглядят так:

[source,java]
----
// sample comment...

/*
sample comment
*/

----

*Javadoc* ничего не делает с такими комментариями.

Чтобы включить контент в *Javadoc*, добавляем две звездочки в начале, перед классом или методом:

[source,java]
----
/**
*
*
*
*
*/

----

Формат для добавления различных элементов выглядит следующим образом:

[source,java]
----
/**
* [short description]
* <p>
* [long description]
*
* [author, version, params, returns, throws, see, other tags]
* [see also]
*/
----

Реальный пример комментариев метода в *Javadoc*:

[source,java]
----
/**
* Zaps the roadrunner with the number of volts you specify.
* <p>
* Do not exceed more than 30 volts or the zap function will backfire.
* For another way to kill a roadrunner, see the {@link Dynamite#blowDynamite()} method.
*
* @exception IOException if you don't enter a data type amount for the voltage
* @param voltage the number of volts you want to send into the roadrunner's body
* @see #findRoadRunner
* @see Dynamite#blowDynamite
*/
public void zapRoadRunner(int voltage) throws IOException {
   if (voltage < 31) {
       System.out.println("Zapping roadrunner with " + voltage + " volts!!!!");
   }
   else {
    System.out.println("Backfire!!! zapping coyote with 1,000,000 volts!!!!");
   }
}
----

Описание *Javadoc* и тэги помещаем перед классом или методом (нет необходимости в пробелах между описанием и классом или методом).

=== Общие тэги *Javadoc*

Ниже приведены наиболее распространенные тэги, используемые в *Javadoc*. У каждого тэга есть слово, которое следует за ним. Например, `@param latitude` означает, что параметром является «широта».

link:https://www.oracle.com/technetwork/java/javase/documentation/index-137868.html#examples[Длинный пример тэгов Javadoc на сайте Oracle]

Рассмотрим несколько общих тэгов *Javadoc*:

* `@author` - человек, который внес значительный вклад в код. Применяется только на уровне класса, пакета или обзора. Не включен в вывод *Javadoc*. Не рекомендуется включать этот тэг, поскольку авторство часто меняется.
* `@param` - параметр, который принимает метод или конструктор.
* `@deprecated` - этим тэгом помечаются класс или метод, которые больше не используются. Такой тэг будет размещен на видном месте в *Javadoc*. Сопровождается тэгом `@see` или `{@link}`.
* `@return` - что возвращает метод.
* `@see` - создает список "см.также". Используется в паре с тэгом `{@link}` для связи с содержимым.
* `{@link}` - используется для создания ссылок на другие классы или методы. Пример: `{@link Foo# bar}` ссылается на метод `bar`, который принадлежит классу `Foo`. Для ссылки на метод в том же классе, просто добавляется `#bar`.
* `@since 2.0` - версия с момента добавления функции.
* `@throws` - вид исключения, которое выдает метод. Обратим внимание, что для проверки этого тэга в коде должно быть указано исключение. В противном случае *Javadoc* выдаст ошибку. Тэг `@exception` является альтернативным тэгом.
* `@Override` - используется с интерфейсами и абстрактными классами. Выполняет проверку, чтобы увидеть, является ли метод переопределением.

=== К каким элементам добавлять тэги *Javadoc*?

Тэги *Javadoc* добавляют к классам, методам и полям:

* тэги `@author` и `@version` добавляются только к классам и интерфейсам
* тэг `@param` только для методов и конструкторов
* тэг `@return` только для методов
* тэг `@throws` для классов и методов

=== Модификаторы `public` и `private` в *Javadoc*

*Javadoc* включает классы, методы и т.д., модификатором `public`. Элементы, помеченные как `private`, не включаются в *Javadoc*, если специально не выбран `private` при создании *Javadoc*. Если опустить `public` из исходного кода, по умолчанию класс или метод доступны только для пакета. В этом случае он не будет включен в *Javadoc*.

=== Описание

*Javadoc* предоставляет как краткое, так и длинное описание. Вот пример, показывающий, как отформатирована часть описания:

[source,java]
----
/**
* Short one line description.
* <p>
* Longer description. If there were any, it would be
* here.
* <p>
* And even more explanations to follow in consecutive
* paragraphs separated by HTML paragraph breaks.
*
* @param variable Description text text text.
* @return Description text text text.
*/
public int methodName (...) {
// method body with a return statement
}
----

Этот пример взят из link:https://en.wikipedia.org/wiki/Javadoc[статьи в Википедии]

Краткое описание является первым предложением с кратким описанием класса или метода в *Javadoc*. После точки анализатор перемещает остальную часть описания в длинное описание. Для обозначения начала нового абзаца используется html-тэг `&lt;p&gt;`. Окружать абзацы открывающими и закрывающими тэгами `&lt;p&gt;` не нужно, потому что компилятор *Javadoc* автоматически добавляет их. HTML можно использовать в описаниях, таких как неупорядоченный список, кодовые тэги, полужирные тэги или другие.

После описания вводится пустая строка (для удобства чтения), а затем добавляются тэги. Под тэгами добавить описание контента невозможно. Только методы и классы могут иметь тэги, а не поля. Поля (переменные) имеют только описания.

Первое предложение в примере очень похоже на элемент `shortdesc` в DITA. Предполагается, что это первое предложение является кратким описанием всего класса или метода. Если в одном из ваших слов есть точка (например, `Dr. Jones`), после точки нужно удалить пробел, добавив `Dr.&amp;nbsp;Jones` для его соединения.

Лучше избегать использования ссылок в первом предложении. После точки следующее предложение будет длинным абзацем, поэтому нужно загрузить первое предложение, чтобы оно было описательным. Время глаголов должно быть в настоящем времени, например, _получает, помещает, отображает, вычисляет_ …

Если метод настолько очевиден (например, `printPage()`), что описание _печатает страницу_ становится избыточным и выглядит бесполезным? В этих случаях *Oracle* говорит, что можно опустить фразу _печатать страницу_ и вместо этого попытаться предложить другое понимание. Oracle предлагает:

[quote, Oracle, https://www.oracle.com/technetwork/articles/java/index-137868.html]
____
Добавить описание под именем API. Лучшие имена API являются «само документируемыми», то есть они в основном говорят вам, что делает API. Если комментарий к документу просто повторяет имя API в форме предложения, он не предоставляет больше информации. Например, если в описании метода используются только слова, которые встречаются в имени метода, то это вообще ничего не добавляет к тому, что вы могли бы вывести. Идеальный комментарий выходит за рамки этих слов и всегда должен вознаградить вас некоторой информацией, которая не сразу была очевидна из названия API.
____

=== Избегаем `@author`

Комментируя лучшие практики *Javadoc*, некоторые люди рекомендуют использовать `@author`, потому что значение автора легко теряет актуальность, а элемент управления исходным кодом обеспечивает лучшее указание на последнего автора. (См. link:https://blog.joda.org/2012/11/javadoc-coding-standards.html[Javadoc coding standards] для подробной информации.)

=== Порядок тэгов

*Oracle* предлагает следующий порядок тэгов:

[source,java]
----
@author (classes and interfaces)
@version (classes and interfaces)
@param (methods and constructors)
@return (methods)
@throws (@exception is an older synonym)
@see
@since
@serial
@deprecated
----

=== `@param` тэги

Тэги `@param` применяются только к методам и конструкторам, которые принимают параметры. После тэга `@param` добавляется имя параметра, а затем описание параметра в нижнем регистре без точки, например:

[source,java]
----
@param url the web address of the site
----

Описание параметра — это фраза, а не полное предложение. Порядок нескольких тэгов `@param` должен соответствовать их порядку в методе или конструкторе.

link:https://blog.joda.org/2012/11/javadoc-coding-standards.html[Стивен Коулборн рекомендует] добавить дополнительный пробел после имени параметра, чтобы повысить удобочитаемость.

Что касается включения типа данных в описание параметра, *Oracle* говорит:

[quote, Oracle, https://www.oracle.com/technetwork/java/javase/documentation/index-137868.html#tag]
____
По соглашению, первым существительным в описании является тип данных параметра. (Артикли «a», «an» и «the» могут предшествовать существительному.) Исключение делается для примитива `int`, где тип данных обычно опускается.
____

Пример, который дает *Oracle*, выглядит следующим образом:

[source,java]
----
@param ch the character to be tested
----

Тип данных также виден и из параметров в методе. Поэтому, даже если не включать типы данных, пользователям будет видно, что они собой представляют.

После имени параметра может быть несколько пробелов, чтобы все определения параметров были выстроены в линию.

Тэги `@param` должны быть предоставлены для каждого параметра в методе или конструкторе. Невыполнение этого требования приведет к ошибке и предупреждению при рендеринге *Javadoc*.

Обычно у классов нет параметров. Есть одно исключение: дженерики. Универсальные классы (дженерики) — это классы, которые работают с различными типами объектов. Объект указывается в качестве параметра в классе в скобках: `&lt;&gt;`. Хотя руководство *Javadoc* от Oracle не упоминает их, можно добавить тэг `@param` для универсального класса, чтобы отметить параметры для универсального класса. Детали в link:https://stackoverflow.com/questions/2015972/is-there-a-javadoc-tag-for-documenting-generic-type-parameters[посте на StackOverflow]. Вот пример с этой страницы:

[source,java]
----
/**
* @param <T> This describes my type parameter
    */
    class MyClass<T>{

        }
----

=== `@return` тэги

Возвращают значения только методы, поэтому только методы получают тэг `@return`. Если метод имеет модификатор `void`, он ничего не возвращает. Если в нем нет `void`, нужно включить тэг `@return`, чтобы избежать ошибки при компиляции *Javadoc*.

=== `@throws` тэги

Тэги `@throws` добавляются в методы или классы только в том случае, если метод или класс генерируют ошибку определенного типа. Вот пример:

[source,java]
----
@throws IOException if your input format is invalid
----

Стивен Коулборн рекомендует начинать описание тэга throws с предложения «if» для удобства чтения. Он говорит:

[quote, Стивен Коулборн]
____
За функцией`@throws` обычно следует if … и остальная часть фразы, описывающая условие. Например, `@throws, if the file could not be found`. Это способствует удобочитаемости исходного кода и при его создании.
____

Несколько тэгов `@throws` располагают в алфавитном порядке.

=== Комментарии к конструкторам

Рекомендуется включать конструктор в класс. Однако, если конструктор отсутствует, *Javadoc* автоматически создает конструктор в *Javadoc*, но исключает любое описание конструктора.

Конструкторы имеют тэги `@param`, но не тэги `@return`. Все остальное так же, как и с методами.

=== Комментарии к полям

Поля имеют только описания. Можно добавлять комментарии в поле, если бы поле было чем-то, что пользователь будет использовать.

=== Кейсы, где комментарии не нужны

Oracle говорит, что есть три сценария, где комментарии к документу наследуются, поэтому вам не нужно включать комментарии в эти сценарии:

* когда метод в классе переопределяет метод в суперклассе;
* когда метод в интерфейсе переопределяет метод в суперинтерфейсе;
* когда метод в классе реализует метод в интерфейсе

См. link:https://www.oracle.com/technetwork/java/javase/documentation/index-137868.html#tag[How to write Javadoc comments]

=== `@see` тэги

Тэг `@see` предоставляет ссылку. Существуют различные способы обозначить то, на что надо ссылаться, чтобы создать ссылку. При ссылке на поле, конструктор или метод в том же поле, используется `#`.

При ссылке на другой класс, сначала пишется имя этого класса, затем `#` и имя конструктора, метода или поля.

При ссылке на класс в другом пакете, сначала указывается имя пакета, затем класс и так далее. Пример из *Oracle*:

[source,java]
----
@see #field
@see #Constructor(Type, Type...)
@see #Constructor(Type id, Type id...)
@see #method(Type, Type,...)
@see #method(Type id, Type, id...)
@see Class
@see Class#field
@see Class#Constructor(Type, Type...)
@see Class#Constructor(Type id, Type id)
@see Class#method(Type, Type,...)
@see Class#method(Type id, Type id,...)
@see package.Class
@see package.Class#field
@see package.Class#Constructor(Type, Type...)
@see package.Class#Constructor(Type id, Type id)
@see package.Class#method(Type, Type,...)
@see package.Class#method(Type id, Type, id)
----

Для подробной информации см. link:https://www.oracle.com/technetwork/java/javase/documentation/index-137868.html#tag[How to write Javadoc comments]

=== Ссылки

Создавать ссылки на другие классы и методы можно используя тэг `{@link}`.

Пример создания ссылки из link:https://blog.joda.org/2012/11/javadoc-coding-standards.html[Javadoc coding standards]:

[source,java]
----
/**
* First paragraph.
* <p>
* Link to a class named 'Foo': {@link Foo}.
* Link to a method 'bar' on a class named 'Foo': {@link Foo#bar}.
* Link to a method 'baz' on this class: {@link #baz}.
* Link specifying text of the hyperlink after a space: {@link Foo the Foo class}.
* Link to a method handling method overload {@link Foo#bar(String,int)}.
*/
public ...
----

Для ссылки на другой метод в том же классе используется формат: `{@link #baz}`. Чтобы связать метод с другим классом, используется формат: `{@link Foo # baz}`. Тем не менее, не надо мудрить с гиперссылкой. При обращении к другим классам можно использовать тэги `&lt;code&gt;`.

Для изменения связанного текста, после слова `#baz` пишется: `@see #baz Baz Method`.

=== Предпросмотр комментариев *Javadoc*

Во многих IDE присутствует вкладка *Javadoc*, которую можно использовать для просмотра информации *Javadoc*, включенную для просматриваемого класса.

=== Зачем такие подробности о тэгах *Javadoc*?

Для чего здесь добавлено много конкретных деталей и рекомендаций по стилю тэгов *Javadoc*? Для понимания того, что аннотации для *Javadoc* следуют множеству стилевых соглашений и лучших практик. Эти соглашения и рекомендации не всегда могут быть очевидны или соблюдаются в файлах Java, с которыми приходится работать. Можно добавить большую ценность, просто убедившись, что содержимое соответствует таким стилевым соглашениям.

=== Дополнительная информация о *Javadoc*

link:https://www.oracle.com/technetwork/articles/java/index-137868.html[Oracle’s explanation of Javadoc tags]

link:https://docs.oracle.com/javase/7/docs/technotes/tools/windows/javadoc.html[Javadoc]

== Изучение вывода *Javadoc*

Выходные данные *Javadoc* не сильно изменились за последние 20 лет, поэтому в некотором смысле они предсказуемы и знакомы. С другой стороны, выходные данные устарели и в них отсутствуют некоторые важные функции, такие как поиск или возможность добавления дополнительных страниц. Как же организован *Javadoc*?

=== Резюме класса

Открываем файл `index.html`в директории с *Javadoc*, которую сгенерировали.

Вкладка "Резюме класса" показывает краткую версию каждого из классов. Описание, которое писали для каждого класса, отображается здесь. Это своего рода краткое справочное руководство по API.

image::/assets/img/java/core/javadoc/class-summary.png[Class summary]

Для отображения деталей класса кликаем по его имени (в нашем примере это `ACMESmartphone` или `Dynamite`)

=== Детали класса

При просмотре страницы класса, мы получаем сводку полей, конструкторов и методов для класса. Опять же, это просто обзор. Если прокрутить вниз, то увидим полную информацию о каждом из этих элементов.

image::/assets/img/java/core/javadoc/class-details.png[Class details]

=== Другая навигация

Если кликнуть на вкладку *Package* вверху, можно просмотреть классы по пакетам. Или можно перейти к классу, щелкнув имя класса в левом столбце. Также можно просмотреть все, кликнув *Index*.

image::/assets/img/java/core/javadoc/navigation.png[Navigation]

Для получения справки по организации *Javadoc* нужно кликнуть на вкладку *Help* вверху на навигационной панели.

== Редактирование тэгов *Javadoc*

Разработчики довольно часто добавляют тэги *Javadoc* и краткие комментарии, когда они создают код Java. Фактически, если они не добавляют некоторые аннотации, среда IDE обычно выдает предупреждение об ошибке.

Однако комментарии, которые добавляют разработчики, могут быть плохими, неполными или непонятными. Работа технического писателя с *Javadoc* часто заключается в редактировании уже существующего контента, обеспечивая большую ясность, структуру, вставляя правильные теги и многое другое.

=== На что обращать внимание при редактировании *Javadoc*

При редактировании *Javadoc* обращаем внимание на:

* отсутствие документации (большая часть *Javadoc* неполная, нужно искать недостающую документацию)
* последовательный стиль (соответствуют ли существующие тэги соглашениям стиля Java с аннотациями)
* ясность (некоторые описания неразборчивы из-за проклятия знаний, и без хорошего понимания Java может быть трудно разобраться в них)

=== Редактируем *Javadoc*

Сделаем несколько изменений в классе и методе. Затем заново сгенерируем *Javadoc* и посмотрим на изменения, как они отображаются на выходе.
